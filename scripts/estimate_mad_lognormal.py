import numpy as np
import matplotlib.pyplot as plt
import math
import sympy as sp
import scipy.special


metaphlan_hmp_mad = [0.00033187894736842104, 9.371052631578948e-06, 2.455460526315789e-05, 3.405263157894737e-06, 1.2208552631578949e-05, 1.2605263157894738e-06, 6.092105263157894e-07, 0.0008892440789473685, 2.611842105263158e-07, 0.000994016447368421, 1.5648026315789473e-05, 8.179605263157895e-05, 3.0064473684210527e-05, 0.0009275092105263159, 0.00013578486842105264, 5.540131578947369e-06, 3.9242105263157885e-05, 3.1501973684210525e-05, 1.463157894736842e-06, 0.001106178947368421, 1.03125e-05, 4.6447368421052633e-07, 5.813815789473684e-06, 6.064802631578948e-05, 2.4290131578947366e-05, 4.652631578947368e-06, 0.03755607105263158, 0.020502850657894735, 0.0006830592105263159, 0.004837994078947369, 3.50046052631579e-05, 0.032594252631578946, 0.008588393421052633, 
                 0.006992165789473684, 0.01315944210526316, 0.013868778289473685, 0.0020830019736842106, 0.036956948026315786, 0.00032048355263157894, 0.08574884868421052, 0.004592334868421052, 0.003026511184210526, 0.003724431578947368, 0.05242219539473684, 0.02187439736842105, 0.07177605592105264, 0.06547717171052632, 0.012756486842105263, 0.003719070394736842, 0.017879855921052634, 0.00038861052631578946, 0.01050106447368421, 2.4144736842105263e-07, 0.020339621710526317, 0.0005109631578947369, 0.03543829802631578, 0.0065348611842105265, 3.220657894736842e-05, 1.2134868421052631e-05, 2.6642763157894738e-05, 4.340131578947368e-06, 5.332236842105263e-06, 0.0014466881578947368, 0.004475041447368421, 0.0001926447368421053, 1.2832894736842107e-05, 0.03635565789473684, 
                 6.196644736842106e-05, 0.0011131559210526315, 6.60282894736842e-05, 0.004879207236842105, 0.001074021052631579, 0.01246981842105263, 0.04566242434210526, 0.00034569605263157894, 0.011851275657894737, 0.0011461427631578947, 0.0011601434210526315, 3.445e-05, 4.3822368421052626e-05, 4.2828947368421053e-07, 3.401315789473684e-07, 5.81157894736842e-05, 1.7960526315789472e-07, 8.553355263157895e-05, 2.8881578947368425e-06, 2.891447368421053e-05, 6.332500000000001e-05, 7.374999999999999e-07, 5.9121710526315795e-05, 0.0002101473684210526, 0.000998036842105263, 0.0005632782894736842, 7.662894736842104e-05, 7.391052631578947e-05, 2.3252631578947368e-05, 0.0006566375, 2.5530263157894735e-05, 2.9105263157894737e-05, 6.661184210526316e-05, 0.0008786085526315789, 
                 3.464473684210526e-06, 0.0003259296052631578, 2.9375000000000003e-06, 0.0028325263157894737, 7.666052631578948e-05, 4.459868421052631e-06, 2.0869736842105265e-05, 7.434210526315789e-08, 2.121052631578947e-06, 0.00012619144736842106, 2.25125e-05, 0.0002878013157894737, 1.4575657894736844e-05, 2.1338815789473685e-05, 0.0053133953947368424, 0.000713778947368421, 0.0005606447368421054, 0.036991439473684204, 0.007580148684210526, 0.0016980302631578947, 0.00010854144736842107, 5.323026315789474e-05, 0.0019905269736842104, 0.0009721026315789473, 0.00862773947368421, 0.008786433552631579, 1.8289473684210527e-06, 0.0002916592105263158, 0.0014054401315789474, 0.0006361717105263159, 0.00304005855263158, 0.0016451842105263158, 0.0011736519736842105, 
                 3.239144736842105e-05, 0.0006096605263157895, 4.2552631578947366e-05, 0.0002741342105263158, 0.0015790519736842105, 0.00014913947368421052, 7.848684210526316e-07, 0.00013667565789473685, 0.0004340657894736842, 0.00023886776315789474, 5.500657894736842e-06, 0.0015292078947368422, 0.006372603947368421, 0.0054636697368421056, 0.0005223618421052632, 0.002336073684210526, 0.00011910723684210525, 0.0001244828947368421, 1.1717105263157893e-06, 6.289605263157895e-05, 9.56375e-05, 0.027192887500000002, 0.0001206875, 9.391973684210525e-05, 0.015539813157894737, 0.0003532625, 4.146776315789474e-05, 4.388157894736843e-06, 0.0014068519736842105, 0.002068866447368421, 0.03657028355263158, 1.7684210526315791e-06, 0.00042731578947368423, 0.00012528552631578947, 
                 1.4592763157894737e-05, 3.916447368421053e-06, 1.0276315789473685e-05, 4.370592105263159e-05, 0.0003522111842105263, 1.8155263157894735e-05, 0.00012142828947368422, 1.7279605263157894e-05, 9.17703947368421e-05, 6.342171052631579e-05, 4.353486842105263e-05, 5.4749999999999996e-05, 0.0016670993421052632, 0.001155807894736842, 0.01451962105263158, 5.552631578947369e-07, 0.0005478611842105262, 8.557368421052632e-05, 5.2875e-06, 3.7322368421052634e-06, 0.00013471184210526313, 6.515921052631579e-05, 0.0012104625, 0.0010038947368421053, 1.348684210526316e-07, 9.398092105263156e-05, 0.0013700552631578948, 0.00013680263157894734, 0.0007808605263157895, 0.006455471710526315, 4.8177631578947374e-05, 0.0006213723684210527, 0.0004727427631578947, 3.8489473684210525e-05, 
                 4.175131578947368e-05, 2.1161842105263162e-05, 1.3355263157894737e-06, 5.520394736842105e-06, 4.013815789473684e-06, 4.5986842105263164e-06, 2.3734210526315788e-05, 0.007261965131578947, 0.00014667631578947366, 4.8263157894736845e-05, 7.611842105263158e-07, 3.8956578947368424e-05, 0.004966446052631579, 3.719144736842105e-05, 1.8282894736842105e-06, 3.631578947368421e-06, 0.006411918421052632, 0.004557430921052632, 6.184210526315789e-08, 1.7105263157894736e-07, 3.193421052631579e-06, 7.179605263157895e-06, 4.05921052631579e-07, 1.0697368421052632e-06, 6.0875e-06, 8.828947368421053e-07, 5.043092105263158e-05, 2.217171052631579e-05, 1.1089473684210527e-05, 7.828947368421053e-08, 0.00021608421052631577, 1.1907894736842107e-06, 0.00127515, 0.0001827578947368421,
                 0.009031098026315788, 9.330921052631578e-05, 5.934210526315789e-07, 0.0013494421052631577, 0.002073038157894737, 0.00010365526315789472, 5.380921052631579e-06, 3.0197368421052633e-05, 0.00012511184210526314, 2.3026315789473685e-08, 0.002331469078947368, 0.0004316802631578947, 4.365131578947368e-06, 4.7105263157894736e-06, 1.125e-06, 9.611842105263157e-07, 4.623684210526315e-06, 4.4078947368421046e-07, 0.00037871842105263156, 3.4585526315789476e-05, 4.496315789473684e-05, 2.8289473684210527e-07, 0.00025684407894736844, 6.659736842105262e-05, 1.951513157894737e-05, 5.085526315789473e-07, 5.907894736842105e-07, 1.4118421052631578e-06, 1.881578947368421e-07, 8.960526315789473e-07, 1.6447368421052632e-06, 1.1776315789473683e-07, 6.578947368421053e-08, 
                 1.1907894736842105e-07, 1.558486842105263e-05, 0.00010719736842105263, 2.4164473684210526e-06, 0.0009510342105263157, 4.301973684210527e-06, 9.697368421052631e-07, 7.190723684210526e-05, 4.276315789473684e-08, 1.169078947368421e-06, 0.0001401361842105263, 1.506578947368421e-06, 4.006118421052632e-05, 8.111842105263158e-07, 5.394736842105263e-08, 3.1072368421052626e-06, 6.971052631578947e-06, 1.6447368421052633e-08, 3.6894736842105265e-06, 1.7848684210526316e-06, 0.000313008552631579, 1.0508552631578946e-05, 4.6151315789473675e-06, 7.69078947368421e-07, 2.0197368421052637e-06, 1.1173026315789474e-05, 3.763815789473684e-06, 6.03157894736842e-06, 3.2894736842105264e-07, 9.611842105263157e-07, 1.0376315789473684e-05, 3.625e-07, 8.450986842105264e-05, 
                 0.00020676315789473686, 6.730263157894737e-07, 0.0013403986842105264, 7.735131578947368e-05, 1.843223684210526e-05, 0.0003803651315789473, 1.1796052631578949e-05, 1.0506578947368421e-06, 2.719671052631579e-05, 0.00011013486842105262, 2.895986842105263e-05, 3.663552631578948e-05, 6.132236842105263e-06, 0.00014257960526315792, 0.00025375460526315787, 0.0025639427631578946, 2.5657894736842103e-08, 3.283552631578948e-05, 6.357565789473684e-05, 1.4438157894736842e-05, 0.0001444388157894737, 9.539473684210525e-08, 1.6444078947368422e-05, 4.3349342105263166e-05, 5.651315789473684e-07, 1.6769736842105263e-06, 1.4078947368421053e-07, 1.3776973684210528e-05, 8.58157894736842e-06, 1.5085526315789475e-06, 5.081776315789474e-05, 9.157894736842106e-07, 
                 6.032894736842105e-07, 9.012499999999999e-06, 7.3144736842105265e-06, 1.2986842105263158e-06, 8.355263157894737e-08, 4.605263157894737e-09, 6.271052631578948e-06, 1.480263157894737e-07, 2.6948026315789476e-05, 1.0101973684210526e-05, 8.121052631578948e-06, 1.7105263157894735e-08, 5.733552631578948e-06, 1.7631578947368423e-07, 5.003947368421053e-06, 2.3848684210526316e-06, 6.301315789473684e-06, 9.144736842105262e-08, 1.4519736842105263e-06, 2.026315789473684e-06, 3.513157894736842e-07, 1.118421052631579e-08, 2.5536842105263157e-05, 3.2910526315789475e-05, 1.0167105263157895e-05, 8.098092105263157e-05, 1.697434210526316e-05, 2.1460526315789478e-06, 2.361842105263158e-07, 7.894736842105262e-08, 5.585526315789474e-07, 5.325e-06, 4.288684210526316e-05, 
                 2.6915131578947366e-05, 7.782763157894738e-05, 3.7217763157894734e-05, 2.7644736842105264e-06, 6.42078947368421e-05, 8.238157894736843e-06, 1.268421052631579e-06, 2.3092105263157893e-06, 1.3815789473684212e-06, 3.7223684210526315e-06, 6.894868421052632e-05, 0.00013548618421052632, 5.822236842105263e-05, 0.0002904276315789474, 0.00011794802631578948, 0.00020637368421052633, 6.510657894736842e-05, 3.5276315789473685e-06, 0.00011427039473684212, 1.256578947368421e-07, 0.0002452144736842105, 0.00044245921052631575, 0.0004376861842105263, 2.877236842105263e-05, 2.276315789473684e-07, 5.958092105263157e-05, 1.1802631578947368e-06, 5.722894736842105e-05, 2.907894736842105e-07, 4.764473684210526e-06, 5.131578947368421e-08, 7.136842105263158e-06,
                 1.6721052631578947e-05, 2.7125000000000003e-06, 1.750592105263158e-05, 1.1713157894736842e-05, 1.4351315789473684e-05, 3.4026315789473685e-06, 3.827631578947369e-06, 1.513157894736842e-07, 1.983815789473684e-05, 0.0002181269736842105, 1.8094736842105265e-05, 8.935526315789474e-06, 4.9653289473684213e-05, 2.6138815789473683e-05, 7.30263157894737e-08, 1.5664473684210527e-06, 8.125000000000001e-07, 1.355263157894737e-07, 2.5813815789473685e-05, 8.579276315789473e-05, 9.553947368421053e-06, 4.6131578947368425e-06, 9.539473684210525e-08, 3.3355263157894737e-07, 7.286842105263158e-06, 5.3440789473684206e-06, 4.154605263157895e-06, 1.117763157894737e-06, 2.2611842105263155e-06, 1.0353947368421052e-05, 1.4296052631578947e-06, 8.105263157894736e-07, 
                 3.486184210526316e-06, 4.736842105263158e-08, 1.2421052631578947e-05, 2.6605263157894733e-06, 1.0052631578947368e-06, 2.5342105263157892e-06, 7.875921052631578e-05, 2.9539473684210525e-07, 1.1757894736842104e-05, 1.0974999999999999e-05, 0.00013118552631578948, 2.9736842105263155e-06, 1.355263157894737e-07, 1.3848684210526314e-06, 1.1276315789473684e-06, 6.414473684210527e-07]

midas_hmp_mad = [6.787907361254218e-07, 8.629301108289478e-06, 0.00012053286680741788, 6.548205596222091e-05, 2.622966295580723e-07, 4.297401320479718e-06, 5.170199693925301e-06, 1.913736118313253e-08, 2.425625917363052e-07, 0.0008720562047713015, 0.005267542823740843, 3.921408238e-08, 5.804051099532127e-07, 5.271844262128514e-08, 3.839916614477108e-05, 2.1578284208803617e-06, 4.47363245865783e-06, 2.452921086141687e-06, 1.1308090284959839e-07, 0.011945826462759473, 4.980539776068273e-08, 2.699596740302972e-06, 0.010435034891351886, 0.00038345195391810015, 7.35053592776734e-05, 0.004064633798658546, 6.2674802330815255e-06, 8.755829986506024e-08, 2.958045880142169e-07, 1.0096646188318955e-05, 5.875822675574379e-06, 1.2241379899558234e-07, 4.723254088530079e-06, 
                 0.001827969629550668, 7.056782053209237e-07, 0.0001008920381520467, 8.340605912710442e-07, 7.981918320503213e-07, 6.003557851814057e-07, 0.05580518082963042, 1.7176305342244177e-06, 1.6246289443444579e-06, 9.463132019787951e-07, 6.866562571856186e-06, 3.23580868352008e-06, 5.520020546761284e-06, 5.1720810467335755e-06, 6.060376039551406e-07, 2.0865793706632132e-06, 3.386702989184658e-06, 2.2671298840763054e-07, 1.6515015270353697e-05, 5.976575992851406e-09, 1.1208606617138153e-06, 6.645358528603895e-06, 9.262075751449799e-08, 7.649017292851406e-08, 5.18974042217269e-07, 3.2496534679389155e-06, 0.002032983277053758, 1.999629198004016e-08, 3.979171479558631e-05, 3.1460320757176705e-07, 7.465494833191566e-07, 5.024359349645502e-06, 0.009779687012749212, 
                 2.2867697047584346e-06, 2.0267541485137754e-06, 8.261604616941284e-06, 1.0159115319397591e-08, 0.001276538770645861, 3.443037082048714e-06, 1.1923779438100682e-05, 0.06409315700056369, 0.007241353944075353, 3.326104939861245e-06, 6.188112834426863e-05, 3.0040523721524903e-06, 1.3305249640165103e-05, 2.2672001451369484e-06, 2.7707440460325704e-06, 8.79381258510249e-06, 6.975080484779116e-08, 1.0542348680579395e-05, 8.544205512902812e-07, 1.3680579971606426e-07, 8.378231835237148e-06, 3.353694368379036e-06, 1.3452455052249798e-06, 1.1153877179690762e-07, 1.179680396884699e-06, 2.1074383466453814e-07, 1.1359192031931728e-07, 1.4780009305217312e-05, 2.537965944312048e-06, 0.017427160936130563, 2.510518703942169e-07, 4.804299209183941e-05, 6.187751607698795e-07, 
                 1.0735897116604013e-06, 0.0006373988100120722, 0.0007391345855349571, 1.5815399987670684e-07, 0.00013296064562139874, 5.161471176345382e-08, 0.0010312871347929746, 0.0003366805275702223, 0.0011045420935942827, 5.656021256008553e-06, 2.0227199285599997e-06, 2.0018531180660476e-05, 5.365622628265864e-06, 4.467752687987952e-07, 1.382804790669719e-06, 0.0038516828142397055, 7.390988555143745e-05, 0.00044509137369566734, 3.971773615179301e-05, 3.864300542087882e-05, 5.950665879716065e-07, 5.0570222144497984e-08, 1.02234426592692e-05, 0.009890460859984579, 2.0009509393354615e-06, 8.58286599746988e-06, 1.2719782094618475e-07, 6.287066513348675e-06, 1.0386981054545783e-06, 1.6005645073365462e-06, 4.307437557028112e-08, 5.211879371759399e-06, 0.0034855298622678416, 
                 3.2165586387831325e-08, 2.2256586360843376e-07, 6.666659378071688e-06, 2.8287603491606426e-08, 1.1955131837080322e-06, 0.018193950360677946, 8.795182718934092e-05, 2.0138124992829325e-06, 2.617331676726611e-05, 1.243508105189884e-05, 3.5729335701995985e-07, 3.0352182378389155e-05, 2.2867439340522088e-08, 0.003173040578965038, 0.0006811779458254231, 0.001641544150779448, 3.881990180346322e-05, 0.02645130911076563, 3.130548779301967e-06, 1.6285145930028116e-06, 2.356387370943209e-05, 0.0004592637448346862, 2.1072436449506427e-06, 1.6668840221911244e-06, 2.980823182165903e-05, 5.628343407411726e-06, 5.30768169302008e-08, 2.3520691511538948e-06, 1.7779888271619677e-06, 8.273846809620883e-07, 1.4085924640227311e-06, 1.4140558049910842e-06, 0.19104672555710475, 
                 9.250673437530523e-07, 0.008773199109055095, 1.3580683492393576e-06, 2.100995361304819e-06, 4.754834407780321e-07, 5.050115380090361e-07, 1.6192820251198793e-06, 9.844708785981527e-07, 2.1758601813126505e-06, 4.494543176516827e-06, 5.355807193053053e-06, 2.8145035157314863e-06, 0.00013312551998487989, 0.00014897694543943753, 0.00022732174355575804, 3.870009558880606e-05, 2.673349467212008e-06, 0.0017011025080993494, 0.001117482529550268, 6.474783225834136e-07, 2.144228509972329e-06, 4.411420864185792e-05, 7.626849840803213e-09, 1.4554260216987952e-08, 0.0020877497074911363, 4.719838189262128e-06, 1.6033632498238433e-05, 2.6309542989638556e-08, 0.0030769199531133573, 0.06719284525213866, 0.00018051695801655552, 0.0003940289292879503, 8.557710222971888e-08, 
                 1.9953009288477912e-07, 9.606325706325703e-07, 1.2800150912088354e-07, 9.115720140323668e-05, 1.188005382353647e-05, 4.1032018604417676e-08, 1.0820474110414456e-06, 2.8054385416513254e-06, 4.074399859541485e-06, 8.550795857389559e-08, 1.877335904759036e-07, 1.1367180051767067e-07, 9.214943042080161e-05, 9.657601259570899e-05, 2.207996508286747e-06, 8.404737686114372e-05, 0.0032242752094851046, 0.0005749333033154079, 1.0371787365872088e-05, 0.05238560600463016, 1.1704364803263453e-06, 0.011321548895972604, 2.067897914690763e-07, 1.4966527100544578e-06, 1.0319521292665461e-06, 1.8102846585071484e-06, 2.9659570321161846e-06, 0.00015559241615107955, 3.0097719910837344e-06, 8.874733238095182e-07, 5.826672743549264e-05, 2.2358388624530123e-07, 1.366913305935743e-08, 
                 1.8426602542177914e-06, 0.0007511751229655871, 1.938659899783281e-05, 1.1614938321662651e-07, 0.00043137028015657696, 5.535530700638555e-08, 0.00010384239053426473, 0.006497939662658676, 3.4511124844426097e-06, 0.003326345857293607, 3.0113706151063047e-06, 4.1552942844222575e-05, 0.02104290432505679, 0.003341712887999329, 2.5486826872759835e-06, 2.0718480783757827e-06, 0.0005637818986021236, 0.0015478708662118711, 1.1795945659718875e-07, 1.32970323795747e-06, 1.097521231583606e-05, 3.611980113072739e-05, 0.0003836794723390137, 4.7588642593653816e-06, 4.251908825020855e-05, 3.569461755854579e-06, 7.494862907351004e-07, 4.1741493469983935e-07, 0.0018669963987561883, 3.16466328937751e-07, 1.8896541054436949e-06, 9.577179022135744e-07, 2.3062842244578314e-08, 
                 5.667795414933534e-06, 0.01112038290793548, 3.035331554044177e-08, 8.161350831999317e-05, 2.0048894140232125e-06, 1.3439306884581528e-06, 0.02323359312330694, 1.0109991295176706e-06, 5.690096628370202e-06, 2.013979311370763e-06, 4.193401926851406e-08, 4.806345923844177e-07, 0.005100633280964765, 2.2412001631024098e-06, 1.9437526940534136e-07, 2.357302639521172e-05, 3.4336856537932927e-06, 1.3304710886686747e-06, 2.103796394746988e-07, 4.897784706104418e-08, 1.973108710257028e-07, 2.0869332361963857e-07, 9.982144878047348e-06, 9.420913848991968e-07, 1.942137389890402e-06, 3.4427081222070277e-06, 0.00017315107474499318, 2.3262398501185137e-06, 4.642840448506024e-07, 6.832186796426225e-06, 7.653338495526909e-07, 3.4914825083745465e-05, 4.4087547527710845e-08, 
                 2.1853627495956494e-05, 4.9502783199785124e-06, 0.001551304093697038, 4.695610447578313e-08, 6.190523624257028e-08, 5.431927820269478e-07, 2.586167571375401e-05, 1.2161622692182974e-05, 3.808028064410935e-05, 8.435922671895583e-08, 1.0840090484176706e-07, 0.0007410828699545407, 6.545591023614459e-08, 4.895046499554032e-05, 0.011642293002739062, 5.685699850506605e-05, 8.252809722921686e-07, 1.3878842186674698e-07, 1.6812532549298795e-06, 2.892428300685542e-07, 0.00015686169936232402, 1.5373646775255824e-06, 4.265137878750923e-06, 2.887825053124498e-07, 2.0696337124361444e-06, 0.00040980452027221625, 4.849756003197341e-05, 1.3817388824619276e-06, 2.8497043876953376e-05, 1.7232632471743777e-06, 1.1690716183375502e-06, 6.664466851166025e-06, 0.004876424788984743, 
                 2.4769723128382332e-06, 2.3016125073502007e-07, 0.023891677671907394, 0.000566239863795199, 1.1652851203092369e-07, 3.8338719965646583e-07, 3.138529247083454e-06, 4.019580897199498e-05, 6.536971119673895e-07, 1.4344785465486746e-06, 1.4923797474260321e-05, 1.6931080950240964e-08, 5.745478744040442e-06, 0.007847689543443, 9.491408038308432e-07, 0.000844652032262893, 6.090278344220883e-07, 0.00021949013424655203, 5.231332670433857e-06, 4.2048889025702815e-07, 1.2802657492332245e-05, 1.8943433859534941e-06, 6.769225099041688e-06, 9.872149137148594e-08, 0.00016578011039294888, 2.8766936682679113e-06, 1.8103479113830525e-06, 4.254722108500361e-06, 4.439615966257832e-06, 3.3017832713066664e-06, 3.538299220567502e-05, 3.4721723567672285e-06, 9.347797840048191e-08, 
                 0.00040679823501442116, 1.1610777820171487e-06, 7.671615907414057e-07, 0.018460258793040998, 0.00016386506958830627, 2.1826485895461848e-07, 9.73926194493253e-07, 2.8359074413574295e-08, 9.330530850351988e-05, 2.826445945397591e-07, 2.676832870702811e-07, 0.00018844897002072251, 1.5171366411520882e-06, 1.772966789721478e-05, 4.907631183983936e-08, 2.96031465181502e-05, 0.0017512396499725356, 3.225162047584152e-05, 0.00017401896505759407, 3.530625267807791e-06, 4.361848901771534e-05, 0.0007900539547542221, 2.1041337771904187e-05, 1.0454702621739678e-05, 6.429856754844979e-07, 0.0040786944070846706, 2.797159501393574e-08, 5.92906560338996e-07, 8.288782226350602e-06, 3.08149129875502e-08, 7.985162910218073e-07, 3.3246718199365756e-05, 0.02577337926326502, 
                 3.387527140034137e-07, 3.1220579515322892e-06, 5.390316247309237e-07, 8.05507158226506e-08, 5.351157833214942e-06, 1.970927020444297e-06, 1.0329002614799198e-07, 2.988770597587951e-06, 0.0045749844852513155, 3.6326004223440968e-06, 6.041379136863455e-07, 1.7522925323439758e-06, 7.776439396465863e-09, 4.098924695742972e-07, 6.084787101747229e-06, 0.002369805859633178, 1.7013270741353414e-07, 3.641416894594005e-05, 4.021231778204035e-05, 2.7645400177429717e-08, 4.5530387725823296e-07, 0.0014967087480874223, 0.0002446906575805219, 1.293597838160723e-06, 2.3438742732520083e-06, 6.9645632256661864e-06, 5.888743299737472e-06, 4.577165984914373e-05, 1.4059669508433734e-08, 2.4511454584373096e-06, 0.00022614370592441714, 1.4791583768569074e-06, 4.751093185301205e-08, 
                 0.006135934666815367, 1.69181977423296e-05, 6.437648690446344e-06, 1.1885794679138957e-06, 7.803052016626506e-08, 2.8354726821401607e-07, 8.33825943869478e-08, 1.9577365810841772e-06, 0.0003545092323777832, 2.2702950618642572e-06, 2.0763917067152006e-05, 7.04153655364257e-08, 2.0782326151405623e-06, 6.383849291959196e-06, 9.491076895224386e-05, 8.339340797704216e-06, 1.1524424754502009e-07, 2.8478607051072656e-05, 9.779008346553425e-05, 6.067537245662651e-08, 1.106630799701807e-06, 5.690072516480067e-05, 1.0041755947611404e-05, 2.9933827554775103e-07, 0.0013611605348270688, 0.0001171044164869078, 1.596994331829719e-07, 7.265851755897993e-07, 9.52988331415261e-08, 1.1747010104843374e-07, 6.906360773116267e-06, 4.7994724424940965e-06, 1.7039025117160243e-06, 
                 0.00022421780675280285, 5.5332915946811234e-05, 4.55933846032249e-07, 6.869354964483695e-06, 2.137186099606948e-06, 0.0003532960293523061, 3.8056662865216865e-07, 0.0010513106564345792, 8.958050859147793e-07, 2.1957146060022894e-06, 1.5852215744344136e-05, 1.5904311400923694e-07, 6.346041455386723e-05, 7.930760546122089e-07, 1.257190328932932e-06, 3.62243555842241e-06, 0.008259825765841524, 2.963789406923695e-08, 1.58572582759249e-06, 1.1896263244401608e-07, 5.2339150862249e-08, 0.007594305523455445, 3.819225236169107e-05, 2.423403629114217e-06, 9.995069227827308e-05, 5.413470854637109e-06, 1.076885998067012e-05, 7.131664543333333e-07, 5.988313650832932e-07, 7.674092264973093e-07, 1.38699654824498e-07, 5.656280141981727e-06, 5.73022469669237e-07, 
                 0.02430205106771403, 6.984884779855521e-05, 4.811309771096385e-07, 3.946368900895181e-06, 3.372908291460241e-07, 0.0011702853082968658, 1.2623761803704818e-06, 0.0012316825881022006, 2.6773046879076305e-08, 0.00021143411911681226, 1.024022215498129e-05, 9.531630654136548e-09, 4.633562425971485e-06, 2.202190263798193e-06, 0.019201949663401018, 1.1016684426332127e-06, 3.13959111362249e-07, 2.552781878267611e-05, 6.594995246520562e-06, 6.606754664092169e-06, 8.250659031047066e-06, 7.66992962625245e-06, 2.7568843379076304e-08, 1.9461183506104416e-07, 1.6087822632622893e-05, 2.9038432381726906e-08, 9.598987231485943e-08, 8.736447314779116e-08, 0.00016389660093666902, 0.0026942078829444724, 1.9009866630047263e-05, 6.7836209681912045e-06, 7.220932512646265e-06, 
                 2.3343703703261043e-07, 1.64607678188755e-07, 2.432126818093735e-06, 1.1661160339437751e-07, 1.5660611106049002e-06, 4.666667644387591e-06, 2.649923451738835e-06, 5.665933680106225e-06, 2.059125793826707e-06, 9.210311906571085e-07, 7.80663793605056e-06, 0.001314146555043606, 2.887862845061044e-07, 1.6772210037991965e-07, 3.935822924999719e-05, 1.740082862151526e-06, 2.9460191528933903e-05, 0.0016944280020290497, 5.147181275139768e-05, 5.0443862042690766e-08, 1.6466831529795181e-07, 8.247722427568914e-06, 5.805753705594015e-06, 2.250989655492851e-06, 1.4587820780112452e-07, 7.622751916348594e-07, 5.935970069362651e-07, 1.4614122703905217e-06, 2.504626791127711e-07, 0.0007838494461676665, 9.271726833212851e-09, 1.772239819111486e-06, 6.213000751325302e-08, 
                 0.006160428853346932, 5.004423237497992e-07, 4.474800064853695e-05, 1.2328002290775382e-05, 2.474369407744659e-06, 7.493842758126345e-06, 3.424712027543373e-07, 3.924850868772651e-06, 1.1018383809959839e-07, 0.0011474246370609073, 4.505167853853815e-07, 1.8220765704590364e-06, 5.1566057871365165e-05, 1.0551597367091807e-05, 3.9505731518749796e-06, 1.6868273599723652e-05, 2.0827341329759038e-07, 3.329973788012153e-05, 3.3216265666489163e-06, 8.084717841541284e-06, 5.683037162600804e-07, 4.096146532767711e-06, 1.5776277623175904e-06, 6.453137495282554e-05, 4.1302297778695985e-06, 3.556939553965522e-05, 3.7087614993514862e-06, 2.3430225077410038e-06, 8.725339442126544e-06, 8.190862328453815e-07, 7.898558248352812e-06, 4.2844148026609964e-05, 1.0077598717670682e-07, 
                 9.398794958963856e-07, 1.1375896187670681e-06, 1.8951984074337347e-08, 4.1242499178714856e-08, 0.00022115187192461714, 1.7911652693742168e-06, 9.135576783749798e-07, 1.6994614588995984e-08, 1.072863715907948e-05, 1.3391351324885505e-05, 8.816907204755019e-06, 1.558135529232008e-06, 7.205069998451406e-07, 4.586973845220883e-08, 4.169014825102823e-05, 1.8415286307695582e-06, 8.790628646503775e-06, 3.655837563493976e-07, 9.230128990803213e-08, 2.2571921491269078e-07, 0.001164565299688245, 4.188604836569959e-06, 0.00015016629669919679, 1.2082886261686747e-07, 5.98855320639759e-08, 8.049379432248996e-09, 2.1790491637229722e-06, 0.000972389140671376, 2.718151678212952e-05, 6.530487089037631e-06, 1.020464096092691e-06, 4.3406333470638554e-07, 1.3903841668994376e-06, 
                 1.4760525303463856e-06, 3.0416920960396388e-06, 6.364700543405663e-06, 8.615004538408836e-07, 1.4227174274942973e-06, 8.959974681526103e-05, 7.828146234947792e-07, 1.6796474980039354e-06, 1.6374014167105944e-05, 4.788162460020643e-06, 3.893440350294457e-06, 2.3953247239146988e-06, 3.798425494582329e-08, 0.0027769584391686415, 0.012571675323893796, 1.3834070306281127e-07, 4.742687435406666e-06, 3.628556059374819e-06, 1.4709294159116465e-08, 0.004481769444986812, 6.473735157821461e-05, 5.3675632210040155e-08, 1.6359004142128516e-07, 2.567660335036506e-06, 4.634375281004016e-08, 1.1332178843935743e-07, 5.850201960802048e-06, 9.377510658893213e-06, 3.1354694422276306e-05, 0.02729592537143627, 4.039973220929479e-06, 0.0006008665876778059, 2.815775404947791e-05, 
                 8.107234796961164e-06, 4.5537863549404017e-05, 1.4243375593032127e-07, 5.648172994273092e-08, 4.141204126586345e-07, 0.00035420603262539634, 4.4629993322891564e-08, 1.4676876893172692e-06, 2.848986603191928e-06, 1.4353783288968273e-05, 5.389153677285542e-07, 1.6994336054056225e-07, 8.17088102570863e-05, 1.2616836231220885e-06, 0.035496137704459065, 6.1688466443871495e-06, 2.868601768554217e-07, 3.728574995859438e-07, 2.2920271366112452e-06, 4.703261561305221e-06, 7.405667555587275e-05, 6.886298513430121e-07, 5.7106886658729726e-06, 3.7926802559795184e-06, 0.008569609303062617, 0.00025925155013763846, 0.00015408742033112948, 9.843603644467032e-06, 5.939298200750039e-06, 4.52774652419755e-06, 0.00023250233974303104, 7.530526537815022e-06, 1.037934217543052e-06, 
                 8.70364363442751e-06, 1.1739963318915663e-07, 1.7784189312940966e-06, 0.00014231163172863203, 0.006138266122799384, 1.4988801571388998e-05, 1.0922596981270038e-05, 5.214655105530198e-06, 1.6303415490181523e-06, 4.326471646563454e-06, 4.5754008731325305e-08, 5.961695751618474e-08, 1.0120742770165864e-06, 0.0017752382990761236, 3.2606890461232524e-06]

midas_af_mad = [5.2560422097495064e-05, 8.39959828787469e-05, 1.665570283105247e-05, 0.0009279373830668585, 5.3398890439086415e-06, 0.010125743544355078, 0.006129208560395745, 9.974409491790124e-08, 0.007188539448324554, 1.6749067199373458e-05, 0.02555358986789216, 9.86089427765432e-07, 4.318639282708642e-06, 1.0300956357222221e-07, 1.482818228674074e-06, 3.00019168158642e-07, 7.09026505598395e-06, 4.507570043669567e-06, 9.509611376148148e-06, 8.340750556120928e-05, 6.383369766358025e-07, 8.529644109530248e-06, 0.015195742593420925, 4.090189153981481e-06, 0.003672238674041903, 2.872978711362901e-05, 2.3906953568838892e-05, 4.727911124727778e-06, 3.808823791438519e-06, 0.0023148879417621577, 1.3096942047030247e-05, 3.245682300774197e-05, 0.00021243834608398462, 6.989372224270401e-05, 
                1.3175170202424076e-05, 0.0011750297410112274, 2.948794686756544e-05, 2.8481747331834563e-05, 1.5801730697321666e-05, 0.0008834589271982152, 1.9195571555869753e-05, 1.881540609678642e-05, 2.270843869969136e-06, 4.836694606423457e-06, 1.837947625843685e-05, 5.6753598725401224e-06, 7.610181979319136e-06, 1.2813542894128396e-05, 1.6859017185970375e-05, 1.697112318299296e-05, 0.00020500226366603472, 3.524177921963889e-05, 1.316310125554321e-06, 8.055629069629629e-06, 0.0001859412688525148, 4.258872944770371e-07, 1.9041596366876542e-06, 3.642576636876543e-07, 7.02899067269321e-06, 4.1502041851769754e-05, 9.006301243755865e-05, 6.955947108909382e-05, 3.009902269222222e-06, 0.00017621186023924503, 2.103480070114506e-05, 0.01578555533914469, 5.985314624519753e-06, 
                8.574797053495063e-06, 1.6864936932922224e-05, 1.3096874806498765e-05, 0.0018946875030939638, 5.769940792828042e-05, 4.047921527673334e-05, 0.0029695590239919474, 0.0012072588169424472, 0.005290119489687908, 0.004975341815397698, 2.9827761834727157e-05, 4.694657010158642e-06, 6.009223893141976e-06, 3.9346516537283947e-07, 2.7344227460129627e-06, 6.024949005555555e-07, 1.104515623077716e-05, 6.823947599574073e-07, 8.763860216234568e-08, 2.4966619092579635e-05, 0.001147626502705077, 1.9972110027959265e-05, 2.8974959383991356e-05, 5.8624014643641974e-08, 3.064680543185926e-05, 1.7171805081944445e-06, 0.007458140433838162, 2.940922487177469e-05, 0.0021444766742743566, 3.729066912987654e-07, 0.0007262382973783005, 4.186497740765432e-07, 0.0008183027029768071, 
                0.004968482761428023, 5.884550643654816e-05, 2.3347700498251847e-05, 0.0015563224498939961, 3.322754158427037e-05, 0.004569270907172523, 0.0037709218334922865, 0.0022097373052547384, 1.859142782436728e-05, 1.000065291468463e-05, 3.197441003682037e-05, 8.672100125699445e-06, 4.098194539465617e-06, 7.6014432467411125e-06, 0.00010898827723282464, 1.2749721466262962e-06, 0.0014985713399345753, 0.007031919173049989, 7.159270965574693e-06, 0.00015295529859156172, 1.1499028785475308e-06, 4.1641211743006785e-05, 0.05335058699835097, 7.45410618909506e-06, 5.395133636086419e-07, 5.327817055216049e-07, 1.4907997361727157e-05, 8.321677352530864e-07, 3.491248535937037e-06, 1.780916990141358e-06, 3.790143932296789e-05, 3.933524512230549e-05, 6.446446334938271e-07, 5.912810360418518e-06, 
                3.4389843625123457e-07, 6.078538865162962e-07, 6.948666826359877e-06, 0.0006046244471962656, 0.004444614814267241, 1.1638489800674258e-05, 0.0031628801925559667, 8.797583847265432e-07, 4.0663980173548764e-05, 1.1003669876745062e-05, 2.5881757871017904e-05, 0.013440423009920176, 0.0015407604883157613, 0.00019626635817585368, 0.0004153891212044921, 0.0018454638812401458, 1.3409971856432713e-05, 1.402009155176358e-05, 5.124392088171605e-06, 2.8026812761529627e-05, 4.163595380622222e-06, 4.56900386402321e-05, 0.00021157153531768715, 3.2106335418475304e-06, 4.4275087014666665e-06, 0.0003745011796785078, 3.0357499434227157e-05, 6.43850670809321e-06, 2.9309591167341977e-05, 3.0453025982098763e-06, 0.00501349028645122, 1.329220953382716e-06, 0.005076068854436039, 
                0.00030249197475122033, 1.1686349895990741e-05, 1.1064666859876544e-07, 1.1571192415527777e-05, 9.032603799264816e-06, 0.00010791248241915065, 2.161184799728889e-05, 1.0460155778674753e-05, 6.740639589746912e-07, 1.1509355372282717e-05, 0.01342043504634094, 5.19174368838179e-05, 0.003454355930822716, 8.121912182610495e-06, 2.9887961082132098e-05, 0.017297596366629184, 9.170380876278396e-05, 5.658909909863581e-06, 3.920980605419322e-05, 1.8095409714444446e-06, 2.892893358654321e-08, 4.197697496324753e-05, 9.498243866234753e-05, 3.662011820887839e-06, 0.00019550787150467388, 1.2586674945555555e-06, 3.479662231976358e-05, 0.0032645782009728896, 0.0054760885357342005, 7.207093935211605e-05, 6.043005263635803e-07, 6.335200203557283e-05, 7.122967434621916e-05,
                8.040416240287962e-05, 4.1968332033086423e-07, 1.9275266401352476e-05, 2.1151876111672222e-06, 0.00012434799040677959, 8.523951741066665e-06, 2.673435370520371e-07, 1.5249051663709878e-05, 1.933667671419753e-07, 0.0016370121211729172, 0.00022145081835520867, 0.0001922376920200481, 0.00010317877682323946, 5.19986650801537e-05, 0.0012707446911833173, 0.012241979631753948, 0.00015751454796766295, 0.0001597656197269858, 1.0705586582469136e-07, 0.0010230554105451243, 6.882947043650865e-06, 5.539149690356174e-06, 1.7344329452807407e-05, 1.5386714256256172e-05, 6.8693208084265435e-06, 0.00017347129031648273, 1.6892647142257408e-05, 1.1988566714624075e-05, 0.0005670497777367511, 2.8346381106475306e-05, 2.2308214172098765e-06, 1.905758654502012e-05, 0.003181019789503471, 
                1.6011943455123456e-06, 7.414293837951666e-05, 0.003595082864831403, 1.5030614578814815e-06, 0.0005328426694337827, 1.83921227586e-05, 3.407261741299568e-05, 0.00017389899182833644, 5.2821126921316665e-05, 2.8529341650971176e-05, 0.0013668663878714919, 0.00021563264273941722, 1.7103182061764816e-05, 1.9973948103821604e-05, 0.004205332437392879, 0.02338034625504198, 1.0132024814444445e-07, 4.1344105269753085e-06, 2.8572137986188268e-05, 7.073490306067873e-05, 5.75817293212605e-05, 0.0001224454367889068, 2.2609097739451854e-06, 0.0007090835380372284, 1.7539760328734565e-06, 7.31462796658642e-07, 7.386062732918395e-05, 0.00342105044928137, 4.206559273448765e-06, 0.00039333230244925356, 1.1590653639506171e-06, 0.0011792465397007436, 0.00592863344695957, 0.00013027221830355556, 
                4.4815838446782107e-05, 7.669927617885186e-06, 5.90226902891358e-07, 0.08170342963872693, 6.3109701862277785e-06, 5.858486971880247e-06, 2.9454387924085808e-05, 0.0006597055341156422, 1.0865363852893209e-06, 0.013575664478840605, 1.6041675882098766e-07, 0.00029752365917463643, 4.817818871850617e-06, 0.0027985042342026, 1.5800388034301232e-05, 5.281624601930864e-07, 4.926355662257408e-06, 1.463018938882716e-07, 1.955886424728395e-06, 1.7660112597024692e-06, 2.244810781412963e-06, 1.2816110009930863e-05, 0.00010973763586956421, 0.0014820079337273739, 8.372157375882715e-06, 0.00323145574665961, 0.0007306445073921542, 2.7010398933827156e-06, 0.0020866135435794846, 3.6911919762469135e-06, 2.1442680923736418e-05, 1.6370010421368518e-05, 0.007595568849679275, 1.0981096333333333e-06, 
                9.884128424006173e-06, 1.5066917600183334e-05, 4.972543044591975e-06, 3.836627712227136e-05, 0.00036269105921261116, 1.4298848218265432e-06, 7.4367553739e-06, 0.013689390724198577, 3.4856871543379015e-06, 4.413559883587715e-06, 0.00015066820285258083, 0.004519536942292096, 6.04388523241889e-06, 4.426630457819753e-06, 3.52426825178929e-05, 2.0654981523148147e-06, 0.007688160141748061, 3.0109905564950616e-06, 0.00024721473802368545, 1.5049676835432098e-06, 0.0003815398920003143, 0.0009884552619729879, 4.805255757882716e-06, 1.2047780023580247e-06, 2.558366324115432e-06, 9.27667985468642e-06, 9.981844719742593e-07, 0.0007900955958978206, 0.011526607999430937, 2.751600634465432e-06, 6.918963547469137e-07, 1.5749899347543826e-05, 0.0006997515068550432, 2.3442259021407405e-07,
                4.714877517947531e-06, 1.2450724495292594e-05, 7.681927725925926e-07, 1.0386156601981234e-05, 1.326735905236358e-05, 0.00018366223195661482, 6.072129556629629e-07, 7.967753978460353e-05, 0.003073992297370813, 0.00013843837815000925, 4.158049104657839e-05, 5.197142851135803e-07, 0.0023290123836742197, 9.300328813512963e-06, 9.925986244669569e-05, 5.830074311784258e-05, 1.1132475601872839e-05, 2.3211380204611116e-06, 2.4439307421049384e-07, 0.002354289411024073, 1.4291489401860494e-05, 0.00012029389350360188, 8.726402308630863e-06, 5.312752637223456e-06, 1.1697257294269754e-05, 4.030939044074074e-07, 1.1452908382714199e-05, 2.9032007064549382e-06, 0.0028772349619656393, 9.411319493621606e-06, 4.353068393401235e-07, 0.0008043367371085176, 1.0835305427407407e-07, 
                0.00014691450495627457, 4.250361070559259e-06, 1.3896637996604936e-07, 1.3125673957512347e-05, 5.833113323876543e-07, 2.8472916612623456e-06, 4.5243180500888886e-06, 6.433967685370371e-07, 8.414468775512345e-07, 2.485426000425926e-07, 3.533780892169136e-05, 0.0002583202901016321, 6.723953697123457e-06, 0.0035002360303927928, 4.122177265380865e-06, 0.0007222513426035986, 0.0016169811584392613, 2.6248610710339508e-06, 0.0008173529592439168, 2.0544126492857406e-05, 2.719640092402222e-05, 6.849932248641975e-07, 0.00015221926772692647, 4.011131635664198e-06, 1.3918466431814813e-06, 1.5158975069293209e-05, 5.2217155630622855e-05, 0.0006630283734020501, 4.4026136513032705e-06, 2.477692508296852e-05, 6.714664602962963e-07, 1.2370536838154323e-07, 9.527140547152469e-06, 
                1.244063936338642e-05, 2.4325298683806788e-05, 4.994708672144815e-06, 0.010934538465575159, 9.802494151616666e-06, 1.1176244869253088e-05, 3.844368564196296e-06, 3.8901969704691357e-08, 0.007011716009269007, 5.4643455363203096e-05, 0.011769428485201088, 2.087982243447901e-05, 2.959509765351852e-06, 1.4811925086790124e-06, 4.4766599743037025e-06, 4.21468827587037e-07, 9.674588990716667e-06, 1.3371840945362347e-05, 5.4351386792283946e-08, 6.479325341802469e-06, 1.4210171604443212e-05, 1.8643231410391975e-05, 0.0004817532849719932, 3.8156030890987653e-07, 8.840949106456791e-06, 1.8819806782248763e-05, 4.5434107372672845e-06, 2.276356862125185e-05, 1.892076329529506e-05, 9.390892894700185e-05, 8.387051992739815e-05, 2.3247966834153705e-05, 2.738051350728889e-05, 
                2.793019305037037e-06, 2.853687002987654e-07, 0.00011888030080265497, 0.00018331965165131853, 7.994945325308642e-08, 4.628730432816667e-06, 3.332081189808642e-07, 4.8714971667160495e-08, 1.049976509165e-05, 1.1392258549104937e-06, 2.0339520619157407e-05, 3.9033741795308646e-06, 6.884274592465064e-05, 0.0011085802500272047, 1.2358322405354321e-06, 5.2089720071796305e-06, 0.0019173497293217148, 1.4045856177962962e-06, 3.416981417836728e-05, 0.0038226947513835922, 0.0009099942147299388, 3.76045017608642e-07, 4.134214332019136e-06, 3.5870370680950616e-06, 9.8571445329321e-07, 1.0494893117132718e-05, 0.00014849676772950125, 6.585593472077778e-06, 8.721038397416667e-06, 0.001115184917771726, 1.3891704242962962e-06, 2.786365597101852e-06, 1.008823582442284e-05, 
                0.005553422130634154, 0.00027863021369588947, 0.0038333639341088647, 5.831105647153703e-06, 8.860282740683334e-06, 1.7374032167559262e-05, 3.5483668756530865e-06, 1.180813046311111e-05, 1.5230916608932715e-05, 3.3267161542376544e-06, 1.0768238394036419e-05, 0.019964380054777124, 1.8597926355623457e-05, 8.320746463568517e-06, 4.041569667582099e-06, 2.969129788970988e-05, 0.0036965535388663448, 1.7721127487324688e-05, 1.0236457340546295e-06, 0.00029063949401134386, 5.26243767752037e-06, 1.5350613213259878e-05, 3.627773719604938e-07, 1.6336429781481481e-06, 5.515204021787037e-07, 1.2695415254753085e-05, 6.622574797282717e-06, 6.545104370038889e-06, 0.001763151696416644, 0.002230901352862977, 1.6611345534567903e-07, 0.00017602074018692657, 1.4968750103486423e-05, 
                0.0005134938904054632, 1.0030553155108024e-06, 1.2333520457123457e-06, 3.2709380768814813e-06, 0.0037447926234299793, 0.00013033793601767494, 5.281177831425926e-08, 5.407518870680864e-06, 6.550392523288643e-06, 0.001855499692622907, 6.949240824069753e-06, 9.078325296870371e-07, 0.00014547239808784004, 1.4117504538849999e-06, 0.00016178341215600679, 0.0001064338304938692, 1.4466583255721359e-05, 6.285952123914814e-06, 1.4198281200780863e-05, 0.00013699328555638759, 2.0665818976462964e-06, 2.420716458520142e-05, 3.483049808716049e-08, 1.250484312567901e-05, 0.00786347075465994, 3.66134674701179e-05, 2.895111105798519e-05, 0.00011707950840979936, 1.7185556883950618e-06, 2.690727597508025e-06, 1.954435591226543e-06, 1.3191584007282099e-05, 1.460215210454506e-05, 
                5.829784021525185e-06, 6.408358535289507e-06, 1.04130408897963e-05, 3.209323289969753e-06, 4.711601723557407e-06, 2.9633289346801844e-05, 5.0478293130441985e-05, 5.760115722690741e-07, 2.881080743560494e-06, 1.9364823018734566e-06, 2.50536134686716e-05, 4.300683404663519e-05, 0.018195432481658627, 7.455843777037037e-06, 9.837487297839506e-08, 1.8621365538269135e-05, 3.138259774762346e-05, 6.634404624112964e-06, 2.63145274688642e-06, 7.578266517932099e-07, 5.260996963753086e-08, 0.00046949337020111003, 2.3442456482351854e-05, 6.41894594258926e-05, 0.0026630758704950185, 7.010782065265432e-07, 3.7006664181734566e-06, 2.0256563724074076e-07, 3.059505794559013e-05, 0.0002377783108436666, 4.709814717604938e-07, 1.8696271385622283e-05, 0.0003072229214628611, 
                5.695065574561728e-07, 1.5103347889166668e-06, 1.605255627201543e-05, 9.086253645987654e-08, 0.0027968081976008537, 4.5231471854197534e-06, 2.0812189353872835e-05, 4.384898150753086e-06, 2.7971954823070365e-05, 0.0009346385952752859, 2.7950976389850748e-05, 2.0550160286411725e-06, 0.003974607081954818, 2.162231767064506e-05, 1.4926056451180242e-05, 6.341485599087284e-05, 1.0655694053549382e-06, 6.365839055516049e-06, 0.002009678270539782, 6.199121920503704e-06, 0.00018538621369220185, 1.1469537826852469e-05, 9.91257673941358e-06, 2.7623550385522473e-05, 1.7856288014145675e-05, 6.290999732794445e-06, 1.5378094875192593e-05, 3.279691673037037e-07, 0.0002892811275040998, 9.203387966481481e-07, 9.65019440282963e-07, 7.678081093333334e-06, 1.2118390654135803e-05, 
                1.5562382052440433e-05, 1.2927698217006172e-06, 5.7888827222052466e-05, 4.909622172179012e-07, 0.0002210166223685382, 7.103833534691358e-06, 9.008035519698766e-06, 3.3930680664435184e-05, 0.00040357614487098955, 5.426976905585e-06, 1.184353342447531e-06, 2.0509726748290124e-06, 3.122365135723457e-06, 7.65086812862963e-07, 8.126647566975308e-08, 0.00012298191177599385, 2.121781228732697e-05, 0.0020180556775580166, 1.892467720462963e-06, 4.8714971667160495e-08, 3.233465499364198e-07, 1.5617701322090127e-05, 0.005402830992800391, 0.00029370713185425314, 2.6370783890964813e-06, 1.729766364117037e-05, 1.6516386478601234e-05, 2.5156257959366668e-05, 0.00016815880974619564, 2.1620322906119754e-05, 5.375967070225e-05, 7.712578529165986e-05, 1.919778576765432e-06, 
                0.0015845058688427065, 5.897622551691358e-06, 5.843335631648149e-07, 7.165167775745062e-06, 1.1572047527021607e-05, 6.6535766014891355e-06, 7.095878782561234e-06, 5.772848853672839e-07, 0.001281379108233401, 0.0016027284648605705, 2.0474883096537037e-06, 1.372541024154506e-05, 1.0610544953162345e-05, 1.951501962154321e-07, 0.0016488689231982509, 1.7860929782716048e-06, 4.961797294845679e-08, 5.654943461257594e-06, 3.971134640145679e-05, 3.35483386704321e-07, 2.4843009555466674e-05, 0.00017288500227144752, 0.0010935983853167716, 0.006041359815403046, 0.0007153752308354829, 3.048419813349383e-06, 0.10640751170691375, 0.0015391513433339788, 2.8610209851777162e-05, 3.112333937808827e-05, 1.7677966489352468e-05, 7.991412978311728e-06, 9.89906931507963e-05, 0.002310740993807795, 
                4.432031179827716e-06, 2.9877219578888892e-06, 1.093463634191358e-07, 0.002172037719435893, 2.84705413099358e-05, 0.0053892825286297776, 1.1938018174231483e-06, 1.0484948822014814e-05, 0.164783158873883, 4.118578552880864e-06, 2.3550616810493827e-07, 0.0004653425828253346, 0.0001272274450714702, 1.1681139950374073e-05, 0.005385071458328322, 4.761710470382098e-06, 1.1579595210314814e-06, 0.00037586738397534327, 0.00019381572862893948, 0.0020039680900680113, 1.0413871902987655e-05, 1.6148613159776115e-05, 8.12131095593642e-06, 8.997003163680246e-06, 7.167705385398148e-05, 5.559710479987037e-06, 3.0992664521395055e-06, 0.002014979189136521, 2.6172464949587655e-06, 7.855658333290124e-07, 7.734677272092593e-07, 0.0006800547593870573, 4.633170439366296e-06, 0.00018440828171278976, 
                2.5900356189487654e-06, 1.4964959680722222e-06, 1.4627005910096298e-05, 7.318271012419754e-07, 8.82053932007494e-05, 9.71490239092284e-06, 0.0018071297497056805, 7.721206187305494e-05]

def Klogn(emp_mad, c, mu0, s0):
    # This function estimates the parameters (mu, s) of the lognormal distribution of K
    m1 = np.mean(np.log(emp_mad[emp_mad>c]))
    m2 = np.mean(np.log(emp_mad[emp_mad>c])**2)
    xmu = sp.Symbol('xmu')
    xs = sp.Symbol('xs')
    eq1 = - m1 + xmu + np.sqrt(2/math.pi)*xs*(sp.exp(-((np.log(c)-xmu)**2)/2/(xs**2))/(sp.erfc((np.log(c)-xmu)/np.sqrt(2)/xs)))
    eq2 = - m2 + xs**2 + m1*xmu+np.log(c)*m1-xmu*np.log(c)
    sol = sp.nsolve([eq1,eq2],[xmu,xs],[mu0,s0])

    return(float(sol[0]),float(sol[1]))

#mad = metaphlan_hmp_mad
#mad = midas_hmp_mad
mad = midas_af_mad

mad_log10 = np.log10(mad)
#mad_log = np.log(mad)
hist_mad, bin_edges_mad = np.histogram(mad_log10, density=True, bins=20)
bins_mean_mad = [0.5 * (bin_edges_mad[i] + bin_edges_mad[i+1]) for i in range(len(bin_edges_mad)-1 )]
prob_to_plot = [sum( (mad_log10>=bin_edges_mad[i]) & (mad_log10<=bin_edges_mad[i+1])  ) / (len(mad_log10)*1.0) for i in range(len(bin_edges_mad)-1 )]
bins_mean_plot = [10**(bins_mean_mad[i]) for i in range(len(bins_mean_mad))]


#plt.figure()

#plt.scatter(bins_mean_plot, prob_to_plot, alpha=0.5, s=30)
#plt.xlabel('Mean Abundance Distribution')
#plt.xscale('log')
#plt.yscale('log')
#plt.xlim(1e-9,0.2)
#plt.ylim(1e-3,0.2)


x=np.arange(-14,-0.5,step=0.1)
c_values = [1e-8,1e-7]
initial_mu = [-10, -1, -1e-1, 1e-1, 1, 1e1, 1e2]
initial_s0 = [1e-1, 1, 1e1]
mu_estimates_na = []
mu_estimates_af = []
sigma_estimates_na = []
sigma_estimates_af = []
initial_conditions = []
for j,s0 in enumerate(initial_s0):
    for i,m0 in enumerate(initial_mu):
        for k,val in enumerate(c_values):
            c = val
            initial_conditions.append([c, m0, s0])
            (mu_na,sigma_na) = Klogn(np.array(midas_hmp_mad), c, m0, s0)
            mu_estimates_na.append(mu_na)
            sigma_estimates_na.append(sigma_na)
            (mu_af,sigma_af) = Klogn(np.array(midas_af_mad), c, m0, s0)
            mu_estimates_af.append(mu_af)
            sigma_estimates_af.append(sigma_af)
    #plt.plot(np.exp(x), np.sqrt(2/math.pi)/sigma *np.exp(-(x-mu)**2 /2/(sigma**2))/scipy.special.erfc((np.log(c)-mu)/np.sqrt(2)/sigma), label = c)

#plt.legend()







